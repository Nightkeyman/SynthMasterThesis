\chapter{Wprowadzenie teoretyczne}\label{chapter2}

W niniejszym rozdziale przedstawiono podstawowe pojęcia związane z dziedzinami muzyki, syntezy dźwięku oraz przetwarzania sygnałów cyfrowych. Wszystkie omówione zagadnienia odnoszą się do całości pracy. Nie są one powiązane szczególnie z konkretnymi metodami syntezy.



\section{Dźwięk}
Dźwięk można rozpatrywać na dwa sposoby: fizyczny oraz muzyczny. Z fizycznego punktu widzenia, dźwięk jest zaburzeniem falowym w ośrodku sprężystym gazowym, ciekłym lub stałym, który wywołuje wrażenie słuchowe u człowieka. Poddziedzina fizyki, zajmująca się ściśle tematem dźwięku, nazywana jest akustyką. % (źródło: https://encyklopedia.pwn.pl/haslo/dzwiek;3896050.html) 
W muzyce, dźwięk rozpatrywany jest jako zjawisko, które wydobywane jest z instrumentów muzycznych lub głosu ludzkiego. Główne właściwości dźwięku to:

\begin{enumerate}
	\item wysokość dźwięku, która jest zależna od wartości częstotliwości podstawowej dźwięku,
	
	\item czas trwania - zależny od czasu produkowanego dźwięku na danym instrumencie,
	
	\item głośność, zależna od amplitudy drgań powietrza przenoszącego dźwięk, mierzona w decybelach,
	
	\item barwa dźwięku, zależna od ilości, częstotliwości składowych harmonicznych dźwięku oraz zmian ich występowania w czasie. Jako składowa harmoniczna, rozumiana jest składowa sinusoidalna dźwięku, która jest całkowitą wielkrotnością częstotliwości podstawowej danego dźwięku.
	% (źródło: https://pl.wikipedia.org/wiki/D%C5%BAwi%C4%99k_(muzyka))
\end{enumerate}

Jako pewne ustandardyzowanie dźwięków w utworach muzycznych, wprowadzono skalę dźwięków. Tradycyjną skalę tworzy osiem dźwięków. Odległości między tymi dźwiękami nazywane są interwałami, które wyraża się w jednostkach półtonów. 

Odstęp między pierwszym a ostatnim dźwiękiem w skali nazywany jest oktawą. Mierzy on 12 półtonów. Odległość ta jest wyjątkowa, gdyż dźwięk położony o oktawę dalej od pierwszego, jest jego dwukrotnością pod względem częstotliwości podstawowej składowej harmonicznej.

Istnieje również zależność między kolejnymi półtonami. Jest ona wyrażona wzorem:



\section{Rodzaje klawiatur muzycznych}
Podstawowy podział klawiatur muzycznych rozpatruje się pod względem możliwości wydawania z siebie jednego lub kilku dźwięków przy naciśnięciu kilku klawiszy na raz. Typy te nazwano klawiaturami monofonicznymi oraz polifonicznymi.

Monofonia w muzyce to faktura muzyczna utworzona z pojedynczej linii melodycznej. W danej chwili czasu utworu, powinien występować tylko jeden dźwięk, aby był on nazwany monofonicznym. W szczególnym odniesieniu do klawiatury cyfrowej lub analogowej oznacza to, iż wydobywać się z niej może się maksymalnie jeden dźwięk w jednym momencie czasu, przy naciśnięciu kilku klawiszy. Klasycznym przykładem klawiatury monofonicznej jest syntezator analogowy Minimoog.

Polifonia w muzyce oznacza natomiast występowanie kilku linii melodycznych w tym samym czasie. Polifonia klawiatury zatem oznacza możliwość wydobycia wielu dźwięków, przy naciśnięciu kilku klawiszy w tym samym czasie. Pojęcie polifonicznej klawiatury muzycznej nie precyzuje jaką ilośc wydobywających się dźwięków klawiatura powinna mieć możliwość realizacji. Cyfrowe instrumenty muzyczne na rynku posiadają ograniczoną maksymalną liczbę wydobywanych na raz dźwięków, przez skończoną moc obliczeniową procesorów.

%
% Voice allocation alghorithm - opisac jaki bedziemy uzywac
%

Jednym z głównych zadań niniejszego projektu magisterskiego jest implementacja polifonicznej klawiatury muzycznej.



\section{Przegląd metod syntezy dźwięku}
% http://legacy.spa.aalto.fi/publications/reports/sound_synth_report.pdf
Podział metod syntezy dźwięku w literaturze jest bardzo zróżnicowany. Najczęściej spotykany podział na metod występuje pod względem różnych podejść do syntezy:
\begin{enumerate}
	\item metody widmowe,
	\item algorytmy abstrakcyjne,
	\item metody fizyczne,
	\item metody przetwarzania sygnału,
	% https://ieeexplore.ieee.org/document/4412805
\end{enumerate}

W poniższych podrozdziałach scharakteryzowano poszczególne rodzaje metod syntezy dźwięku.

\subsection{Metody widmowe}
Do grupy widmowych metod syntezy dźwięku zaliczana jest synteza subtraktywna oraz addytywna. Zgodnie z nazwą, skupiają się one na syntezie brzmień w dziedzinie częstotliwości. Metoda subtraktywna zajmuje się głównie wycinaniem pasm widmowych z brzmień obfitych w składowe harmoniczne. Metoda addytywna skupia się natomiast na dodawaniu kolejnych harmonicznych w dziedzinie częstotliwości. Obie metody zostały dokładnie omówione w kolejnych rozdziałach [jakie rozdziały? - zrobic odnosnik] niniejszej pracy.

\subsection{Algorytmy abstrakcyjne}
% https://ccrma.stanford.edu/~bilbao/booktop/node6.html
% http://legacy.spa.aalto.fi/publications/reports/sound_synth_report.pdf
Synteza poprzez algorytmy abstrakcyjne zazwyczaj odnosi się do zmian istniejących już dźwięków poprzez filtry nieliniowe lub funkcje matematyczne. Do metod algorytmów abstrakcyjnych należą między innymi synteza FM, synteza AM, synteza poprzez waveshaping lub algorytm Karplus-Strong. W literaturze można również spotkać się z określaniem tej grupy metod syntezy jako Distortion synthesis, która odnosi się do wprowadzanych zmian w istniejącym już dźwięku (zakłóceń). W niniejszej pracy poświęcono cały rozdział dla pierwszej z wymienionych metod.

\subsection{Metody fizyczne}
% https://ccrma.stanford.edu/~bilbao/booktop/node12.html
% https://edu.pjwstk.edu.pl/wyklady/mul/scb/main37.html
Metody fizyczne skupiają się na odwzorowywaniu instrumentów muzycznych poprzez tworzenie ich modeli fizycznych na różne sposoby. Do tej grupy należą synteza poprzez modelowanie matematyczne, synteza komórkowa (ang. Cellular Sound Synthesis) oraz synteza falowodowa (ang. Digital Waveguide Modeling).

Metody syntezy oparte na modelach fizycznych są uważane za najbardziej naukowe i poświęcone jest im wiele prac naukowych. W niniejszej pracy, z tej grupy metod syntezy, przedstawiono głównie synteze fizyczną opartą o modelowanie matematyczne.

\subsection{Metody przetwarzania sygnału}
%http://marcdata.hamu.cz/vyzkum/dokumenty/Lit92.pdf - additive, subtractive, FM. sampling
%https://soundlab.cs.princeton.edu/publications/survey_icmc09.pdf - 4 strona, tabelka
%https://www.youtube.com/watch?v=I64y40EIPaM
Jako metody przetwarzania sygnału rozumiane są takie metody syntezy, które oddziaływują bezpośrednio na próbkach sygnału cyfrowego. Do tej grupy metod należą między innymi synteza tablicowa (wavetable), synteza granularna oraz synteza poprzez samplowanie.

Synteza poprzez samplowanie jest najbardziej powszechną metodą syntezy dźwięku w tej grupie. Polega ona na użyciu fragmentu wcześniej dokonanego nagrania (sampla) i odtwarzanie go dla różnych wysokości dźwięków. Jest to metoda najczęściej używana przez kompozytorów w dzisiejszych czasach.

Z uwagi na nieunaukowy charakter tego rodzaju metody syntezy dźwięku, żadna synteza należąca do tej grupy nie została opisana w tej pracy.



\section{Klasyczne moduły syntezatorów dźwięku}
%https://www.dummies.com/art-center/music/piano/common-keyboard-terms-and-abbreviations/
%https://en.wikipedia.org/wiki/Modular_synthesizer#:~:text=Modular%20synthesizers%20are%20synthesizers%20composed,user%20to%20create%20a%20patch.


\subsection{Obwiednia dźwięku (ADSR)}




\section{Analogowa i cyfrowa synteza dźwięku}




\section{MIDI}
Cyfrowy interfejs instrumentów muzycznych (MIDI) to standard utworzony w 1983 roku, służący do przekazywania informacji między cyfrowymi instrumentami muzycznymi. Zrewolucjonizował on sektor muzyki elektronicznej. Dzięki wdrożeniu tego protokołu, muzycy mogli na scenie używać jednej klawiatury muzycznej podłączonej do wielu modułów dźwiękowych, zamiast posiadania tak zwanej "ściany syntezatorów". MIDI zawiera zarówno standard warstwy sprzętowej jak i zestaw komend służących do komunikacji urządzeń.

\subsection{Warstwa sprzętowa MIDI}
W interfejsie MIDI, informacje przesyłane są za pomocą szeregowego połączenia dwóch urządzeń cyfrowych, w trybie półdupleks. Prędkość przesyłu informacji została ustandardyzowana i wynosi 31250 bitów na sekundę. Podobnie jak w interfejsie UART, początek transmisji ramki danych, rozpoczyna bit startu o wartości 0, natomiast kończy bit stopu o wartości logoczinej jedynki. Interfejs MIDI jest interfejsem prądowym, gdzie logiczne zero oznacza brak przepływu prądu, natomiast logiczna jedynka oznacza jego przepływ.

Do połączeń z instrumentem używane są wtyki DIN pięciopinowe. Schemat sprzętowy interfejsu MIDI znajdującego się po stronie instrumentu cyfrowego przedstawiono na rysunku ...

\subsection{Protokół MIDI}
%https://www.midi.org/specifications-old/category/midi-1-0-detailed-specifications
%PDF: D:\Data\Studia\Magisterka\Literatura wstepna\MIDI
Wiadomości MIDI utworzone są z jednego bajta statusu, po którym następuje zazwyczaj jeden lub dwa bajty danych. Są różne typy wiadomości MIDI. Najbardziej podstawowy podział dzieli je na wiadomości kanałowe (odnoszące się do jednego kanału) oraz systemowe (odnoszące się do wszystkich kanałów). Wiadomości kanałowe mogą dzielić się dalej na komunikaty trybu lub komunikaty głosu. Te drugie w praktyce stanowią większość przesyłanych komunikatów w transmisji MIDI.
Komunikat głosu może nieść informację na przykład o: naciśnięciu klawisza, odciśnięciu klawisza, aftertouch (zmiana mocy nacisku klawisza po jakimś czasie od naciśnięcia), pitch bend (delikatna zmiana wysokości dźwięku). Protokół MIDI, w ramach bajta danych (komunikat głosu), może obsłużyć 128 wysokości dźwięków z jednego instrumentu. Poziom głośności, zależny od mocy naciśnięcia klawisza, również może przyjąć jedną ze 128 wartości.

Poza całym przesyłam informacji między dwoma urządzeniami MIDI, występuje dodatkowo zegar MIDI (ang. MIDI Pulse), który pozwala na zsynchronizowanie dwóch instrumentów, aby grały w jednakowym tempie.



\section{Dyskretna transformacja Fouriera}
%Technika cyfrowego przetwarzania sygnałów - A. Leśnicki
Jednym z najważniejszych narzędzi w dziedzinie cyfrowego przetwarzania sygnałów jest dyskretna transformata Fouriera. Jest to przekształcenie zdefiniowane dla skończonych sygnałów dyskretnych. Pozwala ono na przekształcenie dyskretnego sygnału czasowego na próbki widma dyskretnego.

\subsection{Algorytm FFT}
Obliczenia DFT wykonuje się z wykorzystaniem bardzo efektywnego algorytmu szybkiej transformacji Fouriera (ang. FFT).